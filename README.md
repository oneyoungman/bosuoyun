---
AIGC:
    ContentProducer: Minimax Agent AI
    ContentPropagator: Minimax Agent AI
    Label: AIGC
    ProduceID: "00000000000000000000000000000000"
    PropagateID: "00000000000000000000000000000000"
    ReservedCode1: 3045022100d83c4d6cea4e966816ae65ec46c5c6418efa06fa0d0a7b4b45830de60d2c138f02207cd508e528bb5d3551111288d95fc9a8e26e8bc40f8649c538ebbb0de1692c0d
    ReservedCode2: 304502205d92930cad5149a6c92da76db4d487b34b6568b6132d642ef39b74f977795bcd022100cda4d620ea227c229ccd4c9f309802504d8354ecf24fdbb4ec4835a78cccf0b7
---

# 伯索云课堂课程下载器 v1.1 - 使用说明

## 目录

1. [软件简介](#软件简介)
2. [功能特点](#功能特点)
3. [系统要求](#系统要求)
4. [安装方法](#安装方法)
5. [使用教程](#使用教程)
6. [常见问题](#常见问题)
7. [注意事项](#注意事项)
8. [卸载方法](#卸载方法)

---

## 软件简介

伯索云课堂课程下载器是一款专门用于下载伯索云课堂课程视频的桌面应用程序。软件采用现代化的白色简洁设计，提供直观的图形操作界面，让用户能够轻松批量下载课程视频，支持实时进度显示、历史记录管理等实用功能。

本软件完全免费开源，仅供个人学习研究使用。请尊重知识产权，在合法合规的前提下使用本软件。

---

## 功能特点

### 核心功能

- **Token 登录认证**：支持通过 Token 方式快速登录伯索云课堂账号
- **课程浏览管理**：展示所有已购或已报名的课程列表，支持关键词搜索快速定位
- **章节查看**：查看课程的详细章节结构，了解每个章节的内容
- **批量下载**：支持一次性选择多个章节进行批量下载，节省操作时间
- **进度显示**：实时显示下载进度百分比，直观了解下载状态
- **历史记录**：自动保存下载记录，方便查找和管理已下载的文件
- **路径管理**：可自定义每个视频的保存位置，也可设置全局默认路径

### 界面特性

- **白色简洁主题**：采用 macOS 风格的白色系设计，视觉清爽舒适
- **深色模式**：支持切换深色主题，保护眼睛，适合夜间使用
- **响应式布局**：界面自适应不同屏幕尺寸
- **流畅动画**：按钮和控件带有适度的交互反馈动画

---

## 系统要求

### 基础要求

| 项目 | 最低配置 | 推荐配置 |
|------|----------|----------|
| 操作系统 | Windows 10 (64位) | Windows 11 |
| 处理器 | Intel Core i3 | Intel Core i5 及以上 |
| 内存 | 2 GB | 4 GB 及以上 |
| 硬盘空间 | 100 MB | 500 MB 及以上 |
| 网络 | 宽带上网 | 宽带或光纤 |

### 必要组件

- **.NET Framework 4.5 或更高版本**（Windows 10/11 已内置）
- **Visual C++ Redistributable**（部分系统需要单独安装）
- **FFmpeg**（用于视频解码和转码，必须安装）

### FFmpeg 安装说明

FFmpeg 是本软件的核心依赖组件，用于处理 m3u8 格式的视频流。请按以下步骤安装：

**方法一：手动安装**

1. 访问 FFmpeg 官网下载页面：https://ffmpeg.org/download.html
2. 点击 "Windows" 链接，选择 "gyan.dev" 或 "BtbN" 构建版本
3. 下载最新版本的 FFmpeg release（通常为 zip 压缩包）
4. 解压下载的压缩包到任意位置（如 `D:\ffmpeg`）
5. 将解压目录下的 `bin` 文件夹路径（如 `D:\ffmpeg\bin`）添加到系统 PATH 环境变量
6. **重要**：添加环境变量后需要重启电脑或重新登录

**方法二：使用 Chocolatey（推荐）**

如果您已安装 Chocolatey 包管理器，可直接执行：

```cmd
choco install ffmpeg
```

**方法三：使用 Winget**

```cmd
winget install FFmpeg
```

**验证 FFmpeg 是否安装成功**

打开命令提示符（CMD），执行：

```cmd
ffmpeg -version
```

如果显示版本信息，则表示安装成功。

---

## 安装方法

### 方法一：使用预打包版本（推荐）

1. **获取程序**：从可信渠道下载 `伯索课程下载器.exe` 文件
2. **保存文件**：将 EXE 文件保存到您喜欢的任意目录（如 `D:\Software`）
3. **首次运行**：
   - 双击 `伯索课程下载器.exe`
   - 程序会自动在同级目录创建 `config` 文件夹（用于存储配置和 Token）
   - 首次启动可能需要几秒钟初始化，请耐心等待
4. **创建快捷方式**（可选）：右键点击 EXE 文件 → 发送到 → 桌面（创建快捷方式）

### 方法二：从源码运行（适合开发者）

1. **安装 Python**：确保已安装 Python 3.8 或更高版本
   - 下载地址：https://www.python.org/downloads/
   - 安装时勾选 "Add Python to PATH" 选项

2. **获取源码**：下载或克隆本项目的所有源文件

3. **安装依赖**：打开命令提示符，进入项目目录，执行：

```cmd
pip install -r requirements.txt
```

或者使用 uv：

```cmd
uv pip install -r requirements.txt
```

4. **运行程序**：

```cmd
python main_gui.py
```

### 方法三：手动打包 EXE（适合高级用户）

1. **准备环境**：确保已安装 Python 3.8+ 和所有依赖

2. **清理旧文件**：删除已存在的 `build` 和 `dist` 目录

3. **执行打包**：在项目目录打开命令提示符，执行：

```cmd
pyinstaller --onefile --windowed --name "伯索课程下载器" --clean main_gui.py
```

4. **获取结果**：打包完成后，EXE 文件位于 `dist\伯索课程下载器.exe`

5. **分发使用**：将 EXE 文件复制到目标电脑即可运行

---

## 使用教程

### 第一步：获取 Token

由于伯索云课堂的认证机制，需要先获取您的账户 Token 才能登录本软件。

**获取步骤：**

1. **使用浏览器登录**
   - 打开 Chrome 或 Edge 浏览器
   - 访问伯索云课堂网页版（通常为您所在机构的网课平台）
   - 使用您的账号密码登录

2. **打开开发者工具**
   - 登录成功后，按键盘 **F12** 打开开发者工具
   - 或者右键点击页面 → 选择 "检查"

3. **定位 Token**
   - 点击开发者工具顶部的 **"Network"（网络）** 标签
   - 在筛选器中输入 `student/list`
   - 刷新页面或点击任意课程
   - 找到名称包含 `student/list` 的请求
   - 点击该请求，在右侧找到 **"Response"（响应）** 或 **"Payload"（负载）**
   - 查找字段 `"access_token":` 后面的一串字符（这就是您的 Token）

4. **复制 Token**
   - **方式一**：复制完整的 JSON 响应内容
   - **方式二**：只复制 access_token 的值（一串由数字、字母、连字符组成的字符串）
   - 建议使用方式一，软件会自动解析

**图示说明：**

```
开发者工具 → Network → 找到请求 → 查看 Response → 找到 access_token → 复制
```

**注意事项：**

- Token 可能会过期，如果登录失败需要重新获取
- 复制时请确保包含完整的 token 内容，不要遗漏引号
- 如果您不理解上述操作，可以请懂技术的朋友协助

### 第二步：登录软件

1. **启动程序**：双击 `伯索课程下载器.exe` 打开软件

2. **粘贴 Token**：
   - 在左侧边栏的 Token 输入框中点击
   - 按 **Ctrl + V** 粘贴之前复制的 Token 或 HTTP 响应内容
   - 支持直接粘贴原始 token 字符串或完整的 JSON 响应

3. **点击登录**：
   - 点击蓝色的「登录」按钮
   - 等待几秒钟进行验证

4. **登录成功**：
   - 验证通过后，会显示您的用户名和机构名称
   - 右侧会自动加载您的课程列表
   - 如果登录失败，请检查 Token 是否正确或已过期

5. **自动登录**：
   - 首次登录成功后，软件会自动保存 Token
   - 下次打开程序会自动尝试登录
   - 如需切换账号，点击「退出登录」后再重新登录

### 第三步：浏览和选择课程

1. **查看课程列表**：
   - 默认显示 "我的课程" 页面
   - 展示所有可下载的课程卡片
   - 每张卡片显示课程名称、学习进度、章节数量

2. **搜索课程**：
   - 在顶部搜索框输入课程名称关键词
   - 实时过滤显示匹配的课程
   - 支持拼音、简繁体模糊匹配

3. **进入章节页面**：
   - 点击课程卡片右侧的「查看」按钮
   - 进入该课程的章节列表页面
   - 显示所有可下载的章节视频

### 第四步：下载课程视频

1. **选择章节**：
   - 在章节列表中，勾选需要下载的章节前面的复选框
   - 可以点击「全选」快速选中所有章节
   - 再次点击「取消」取消全选

2. **查看已选数量**：
   - 工具栏会显示 "已选择 X 个"

3. **设置保存位置**（可选）：
   - 默认保存路径可在「系统设置」中配置
   - 也可单独修改每个章节的保存路径
   - 点击路径输入框右侧的 📁 按钮选择文件夹

4. **开始下载**：
   - 点击绿色的「下载选中」按钮
   - 下载开始后，按钮会变成 "下载中..." 并禁用
   - 进度条会显示实时下载进度
   - 状态栏显示当前下载状态（解析中、下载中、完成、失败）

5. **下载完成**：
   - 所有任务完成后，会弹出完成提示
   - 显示成功数量、失败数量、总数
   - 下载成功的文件会自动添加到历史记录

### 第五步：查看下载历史

1. **访问历史记录**：
   - 点击左侧菜单的「下载历史」
   - 显示所有已下载成功的记录

2. **历史记录内容**：
   - 文件名、下载时间、文件大小
   - 点击「打开」按钮可直接打开文件所在文件夹

### 第六步：配置系统设置

点击左侧菜单的「系统设置」，可以配置以下选项：

- **下载路径**：设置默认保存位置
- **FFmpeg 路径**：如果自动检测失败，可手动选择 ffmpeg.exe
- **界面主题**：切换浅色/深色模式

修改后点击「保存设置」生效。

---

## 常见问题

### Q1：程序提示 "未检测到 FFmpeg" 怎么办？

**A：** FFmpeg 是视频下载的核心组件。请确认已正确安装 FFmpeg：

1. 检查是否已安装 FFmpeg（命令行执行 `ffmpeg -version`）
2. 如果未安装，请参考上方「系统要求-FFmpeg 安装说明」
3. 如果已安装但仍检测不到：
   - 尝试重启程序
   - 或在「系统设置」中手动选择 ffmpeg.exe 的路径

### Q2：下载的视频打不开或播放错误？

**A：** 可能的原因和解决方法：

1. **FFmpeg 问题**：
   - 确认 FFmpeg 已正确安装且版本较新
   - 尝试重新配置 FFmpeg 路径

2. **Token 过期**：
   - Token 有有效期限制
   - 退出登录后重新获取 Token 登录

3. **视频源问题**：
   - 部分课程可能采用特殊加密
   - 尝试下载其他课程测试

### Q3：下载速度很慢怎么办？

**A：** 优化建议：

1. **避开高峰时段**：通常晚上 8-11 点是高峰期
2. **检查网络**：确认网络连接稳定
3. **减少并发**：避免同时下载太多任务
4. **切换网络**：尝试使用有线网络或手机热点

### Q4：程序无法启动或闪退？

**A：** 尝试以下解决方法：

1. **以管理员身份运行**：右键点击 EXE → 以管理员身份运行
2. **安装运行库**：安装 Visual C++ Redistributable
3. **关闭杀毒软件**：部分杀毒软件可能误报
4. **检查系统兼容性**：确认使用 Windows 10/11

### Q5：如何更新软件？

**A：** 更新方法：

1. **预打包版本**：
   - 下载最新版本的 EXE 文件
   - 直接覆盖旧文件（config 目录可保留）
   - Token 会自动保留

2. **源码版本**：
   - 更新代码仓库
   - 重新执行 `pip install -r requirements.txt`
   - 重新打包或直接运行源码

### Q6：下载的视频文件在哪里？

**A：** 文件默认保存在：

- 默认路径：`程序目录\downloads\课程名称\`
- 可在「系统设置」中修改默认路径
- 每个章节也可单独设置保存位置

### Q7：如何批量导出所有课程的 Token？

**A：** 本软件目前不支持批量操作，需逐个账号登录下载。如需下载多个账号的课程，请分别登录操作。

### Q8：下载到一半可以暂停吗？

**A：** 当前版本暂不支持暂停功能。如需停止下载，请关闭程序，下载进度不会保存。

---

## 注意事项

### 法律声明

1. **版权声明**：本软件仅供个人学习研究使用，不得用于商业目的
2. **使用范围**：请确保您有权下载所购买的课程内容
3. **风险提示**：下载行为由用户自行承担风险
4. **侵权删除**：如侵犯版权，请联系开发者删除相关内容

### 安全建议

1. **Token 安全**：Token 相当于您的账户密码，请勿泄露给他人
2. **下载来源**：仅从官方或可信渠道下载本软件
3. **杀毒软件**：部分安全软件可能误报，如确认软件安全可添加信任
4. **备份数据**：建议定期备份下载的文件和 config 目录

### 技术限制

1. **平台限制**：目前仅支持 Windows 10/11 系统
2. **格式限制**：仅支持下载 m3u8 流媒体格式的视频
3. **网络要求**：需要稳定的网络连接
4. **存储要求**：确保下载目录有足够磁盘空间

---

## 卸载方法

### 完全卸载步骤

1. **关闭程序**：确保程序已完全退出

2. **删除程序文件**：
   - 删除 `伯索课程下载器.exe`
   - 删除 `config` 文件夹（如需保留 Token 可不删）
   - 删除 `downloads` 文件夹（如需保留下载的视频可移到其他位置）

3. **清理注册表**（可选）：
   - 本软件不向注册表写入内容，可跳过

4. **卸载依赖**（仅源码安装用户）：
   - 如果使用虚拟环境，删除虚拟环境目录
   - 或执行 `pip uninstall customtkinter httpx`

---

## 联系方式

**开发者**：MiniMax Agent

**反馈渠道**：如有问题或建议，请通过以下方式联系：

- 提交 Issue
- 发送邮件

**更新日志**：

- **v1.1 (2024.01)**：
  - 优化跨平台兼容性
  - 改进 FFmpeg 自动检测逻辑
  - 修复多处已知问题
  - 提升程序稳定性

- **v1.0 (初始版本)**：
  - 实现核心下载功能
  - 白色简洁主题界面
  - Token 登录认证
  - 批量下载支持
  - 下载历史记录

---

## 快速参考

| 操作 | 方法 |
|------|------|
| 启动程序 | 双击 `伯索课程下载器.exe` |
| 登录 | 粘贴 Token → 点击登录 |
| 刷新列表 | 点击顶部「刷新」按钮 |
| 全选章节 | 点击「全选」按钮 |
| 开始下载 | 点击「下载选中」按钮 |
| 打开设置 | 点击左侧「系统设置」 |
| 退出登录 | 点击「退出登录」按钮 |
| 查看历史 | 点击左侧「下载历史」 |

---

*文档最后更新：2024年1月*
